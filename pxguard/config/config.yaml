# PXGuard - File Integrity Monitoring Configuration
# Author: phoenixoOor
# Paths are relative to CWD (project root when running pxguard).

monitoring:
  directories:
    - ./test_assets

  scan_interval: 10
  # watchdog_enabled: false   # set true for real-time reaction (requires: pip install watchdog)
  # watchdog_debounce_seconds: 2.0

  exclude_patterns:
    - "*.log"
    - "*.tmp"
    - "*.swp"
    - ".git/*"
    - "__pycache__/*"
    - "*.pyc"
    - "baseline.json"

thresholds:
  change_count: 10
  time_window_seconds: 60
  # Cooldown after threshold alert (seconds)
  cooldown_seconds: 60
  # Anomaly alert cooldown (seconds); default 300 (5 min). Used for report/email on anomaly.
  # anomaly_cooldown_seconds: 300

dashboard:
  # Set to false for headless/CI (no rich Live, use plain dashboard)
  interactive: true
  # Number of scan iterations and log lines to keep in memory
  history_size: 30

alerts:
  log_path: ./pxguard/logs/alerts.log
  console_alerts: true
  min_severity: INFO
  email_alerts_enabled: true
  email_to: "gosha.avakian98@gmail.com"
  attach_visuals: true
  # SMTP credentials are loaded EXCLUSIVELY from environment variables:
  #   PXGUARD_SMTP_HOST     (e.g. smtp.gmail.com)
  #   PXGUARD_SMTP_PORT     (e.g. 587)
  #   PXGUARD_SMTP_USER     (e.g. your_bot@gmail.com)
  #   PXGUARD_SMTP_PASSWORD (app password â€” never put this in YAML)

paths:
  baseline_file: ./pxguard/baseline/baseline.json
  # graph_format: html   # interactive Plotly (change_graph.html); use "png" for static
  # report_summary.txt is written to the same directory as alert log_path

reaction:
  enabled: false
  # When true, PXGuard will attempt to terminate processes responsible
  # for CRITICAL file events (requires psutil and sufficient privileges).
  # Protected system processes (systemd, sshd, etc.) are never terminated.

simulator:
  allowed_root: ./test_assets
